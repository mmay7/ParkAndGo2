{% extends 'ticket/base.html' %}
{% load static %}

{% block content %}


<h1>Enter your meter number</h1>

<br/>
<form action="{% url 'ticket_search' %}" method="GET" value="{{request.GET.q}}">
Search <input type="number" name="q" value="{{request.GET.q}}" placeholder="Search meters"/>
<input type="submit" name="submit" value="Search"/>
</form>


{% if submitbutton == 'Search' and request.GET.q != '' %}
{% if results %}
<h1>Results for <b>{{ request.GET.q }}</b></h1>
<br/><br/>

    <h3>Total Tickets: {{ results.count }}</h3>
    <br/>

  <script src="https://code.highcharts.com/highcharts.src.js"></script>
  <script>
  {% for result in results %}
  {{result.meter_number}}
  {% endfor %}
    Highcharts.chart('container', {
        chart: {
            type: 'column'
        },
        title: {
            text: 'Time Tickets were Given'
        },
        xAxis: {
            categories: [
                {% for result in results %}'{{ result.meter_number }} Class'{% if not forloop.last %}, {% endif %}{% endfor %}
            ]
        },
        series: [{
            name: 'Number of Tickets',
            data: [1],
        }]
    });
  </script>


{% for result in results %}

{{result.name}}
{{result.ticket_number}}
{{result.meter_number}}
{{result.street}}
{{result.date}}
{{result.time}}

<br/>

{% endfor %}


{% else %}
No search results for this query
{% endif %}
{% endif %}

     <h1>Or find it on the map</h1>
    <p><a href = "http://127.0.0.1:8000/maps/">View Map</a></p>
{% endblock %}

